worker_processes 1;

events {
  worker_connections 1024;
}

http {
  limit_req_zone $binary_remote_addr zone=web_limit:10m rate=50r/s;
  limit_req_zone $binary_remote_addr zone=mobile_limit:10m rate=30r/s;

  server {
    listen 80;

    location /api/web/ {
      limit_req zone=web_limit burst=100 nodelay;
      proxy_pass http://backend:8080/;
    }

    location /api/mobile/ {
      limit_req zone=mobile_limit burst=60 nodelay;
      proxy_pass http://backend:8080/;
    }
  }
}
