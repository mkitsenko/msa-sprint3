### <a name="_b7urdng99y53"></a>**Название задачи:** Миграция из монолитного приложения в микросервисы
### <a name="_hjk0fkfyohdk"></a>**Автор:** Киценко Максим
### <a name="_uanumrh8zrui"></a>**Дата:**
### <a name="_3bfxc9a45514"></a>**Функциональные требования**

#### Проблематика:
Реализовать сбор и хранение истории всех покупок:
- Когда они были сделаны, сколько стоили, каким способом доставлены.
- Иметь возможность посмотреть список товаров, их количество и цену, итоговую сумму, способ доставки и оплаты, финальный статус заказа (доставлен, отменён).
- Иметь возможность скачать чек.

Учесть требования к отклику всех интерфейсов приложения.


| **Функциональные требования**                                 |
|:--------------------------------------------------------------|
| Определить и выделить один из сервисов монолита в микросервис |


| **№** | **Действующие лица или системы** | **Use Case** | **Описание**                                                                                                                |
|:-----:|:---------------------------------|:-------------|:----------------------------------------------------------------------------------------------------------------------------|


### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**

| **№** | **Требование**                                                                                                                                                                                    |
|:-----:|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|


### <a name="_qmphm5d6rvi3"></a>**Решение**

Реализовать чтение запись следующих микросервисов по принципу CQRS и Event Sourcing:
- Заказы
- Платежи

#### Плюсы:
- Позволяет распределить нагрузку между чтением и записью
- Синхронизацию между БД чтения и записи реализовать через Event Sourcing.
- Хранить историю события в отдельной БД, чтобы иметь возможность восстановить целостность данных по ним
- Позволяет выдерживать высокую нагрузку

#### Минусы:
- Сложно в реализации
- Требуется больше ресурсов инфраструктуры для реализации

### <a name="_bjrr7veeh80c"></a>**Альтернативы**

Использовать CQRS на одной БД, чтение и запись разделить схемами.
Настроить сбор событий через CDC и хранить историю изменений на уровне Apache Kafka.


#### Плюсы:
- Проще и быстрее реализовать
- Требует меньше ресурсов инфраструктуры для реализации

#### Минусы и риски:
- При кратном росте нагрузки возможно проблемы с производительностью
- Нужно будет делать чаще делать снэпшоты БД
- Хранение событий на уровне брокера сообщений не является лучшей практикой
